#include "kernel/types.h"
#include "kernel/stat.h"
#include "user/user.h"
#include "kernel/proc.h"  // For struct procinfo definition

int main(void)
{
    struct procinfo info;
    
    printf("Testing getprocinfo system call...\n");
    
    // Call the getprocinfo system call
    int result = getprocinfo(&info);
    
    if(result < 0) {
        printf("ERROR: getprocinfo failed with return code %d\n", result);
        exit(1);
    }
    
    printf("SUCCESS: getprocinfo returned %d\n", result);
    
    // Display process information
    printf("\n=== Process Information ===\n");
    printf("PID: %d\n", info.pid);
    
    // Convert state to readable string
    printf("State: ");
    switch(info.state) {
        case 0: printf("UNUSED\n"); break;
        case 1: printf("USED\n"); break;
        case 2: printf("SLEEPING\n"); break;
        case 3: printf("RUNNABLE\n"); break;
        case 4: printf("RUNNING\n"); break;
        case 5: printf("ZOMBIE\n"); break;
        default: printf("UNKNOWN (%d)\n", info.state);
    }
    
    printf("Priority: %d\n", info.priority);
    printf("Queue: %d\n", info.queue);
    printf("Ticks in current queue: %d\n", info.ticks);
    printf("Total ticks: %d\n", info.totalticks);
    
    printf("\nTest completed successfully.\n");
    exit(0);
}
